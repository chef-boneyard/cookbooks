# Generated by Chef. Local modifications will be overwritten.
<% @db_info.each do |env,db| -%>
# Privileges for databases in <%= env %>
GRANT ALL ON <%= db['database'] %>.* TO '<%= db['username'] %>'@'%' IDENTIFIED BY '<%= db['password'] %>';
<% end -%>
<% case @node[:platform] -%>
<% when "debian","ubuntu" -%>
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'debian-sys-maint'@'localhost' IDENTIFIED BY '<%= @node.mysql.server_debian_password %>' WITH GRANT OPTION;
<% end -%>

GRANT REPLICATION SLAVE ON *.* TO 'repl'@'%' IDENTIFIED BY '<%= @node.mysql.server_repl_password %>';

SET PASSWORD FOR 'root'@'localhost' = PASSWORD('<%= @root_pw %>');

flush privileges;
